def max_profit(prices: list[int]) -> int:
    """
    –§—É–Ω–∫—Ü–∏—è –≤—ã—á–∏—Å–ª—è–µ—Ç **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å** –æ—Ç **–Ω–µ –±–æ–ª–µ–µ —á–µ–º –¥–≤—É—Ö —Å–¥–µ–ª–æ–∫** (–ø–æ–∫—É–ø–∫–∞-–ø—Ä–æ–¥–∞–∂–∞).

    üîπ –ê–ª–≥–æ—Ä–∏—Ç–º (–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ O(n)):
    1Ô∏è‚É£ **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
       - `first_buy`  ‚Üí –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –ø–µ—Ä–≤–æ–π –ø–æ–∫—É–ø–∫–∏.
       - `first_sell` ‚Üí –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å –æ—Ç –ø–µ—Ä–≤–æ–π —Å–¥–µ–ª–∫–∏.
       - `second_buy` ‚Üí –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –ø—Ä–æ–¥–∞–∂–∏.
       - `second_sell` ‚Üí –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å –æ—Ç –¥–≤—É—Ö —Å–¥–µ–ª–æ–∫.
    2Ô∏è‚É£ **–ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ `prices`** –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
       - `first_buy = max(first_buy, -price)`
       - `first_sell = max(first_sell, first_buy + price)`
       - `second_buy = max(second_buy, first_sell - price)`
       - `second_sell = max(second_sell, second_buy + price)`
    3Ô∏è‚É£ –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç–≤–µ—Ç: `second_sell`.

    üîπ –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: **O(n)** ‚Äî –æ–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥ –ø–æ –º–∞—Å—Å–∏–≤—É.
    üîπ –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: **O(1)** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ 4 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

    :param prices: list[int] - –º–∞—Å—Å–∏–≤ —Ü–µ–Ω.
    :return: int - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å –æ—Ç –¥–≤—É—Ö —Å–¥–µ–ª–æ–∫.
    """

    if not prices:
        return 0

    first_buy, first_sell = float('-inf'), 0
    second_buy, second_sell = float('-inf'), 0

    for price in prices:
        first_buy = max(first_buy, -price)  # –ü–æ–∫—É–ø–∞–µ–º –¥–µ—à–µ–≤–ª–µ
        first_sell = max(first_sell, first_buy + price)  # –ü—Ä–æ–¥–∞–µ–º –¥–æ—Ä–æ–∂–µ
        second_buy = max(second_buy, first_sell - price)  # –í—Ç–æ—Ä–∞—è –ø–æ–∫—É–ø–∫–∞
        second_sell = max(second_sell, second_buy + price)  # –í—Ç–æ—Ä–∞—è –ø—Ä–æ–¥–∞–∂–∞

    return second_sell


# üîπ –¢–µ—Å—Ç–∏—Ä—É–µ–º
print(max_profit([3, 3, 5, 0, 0, 3, 1, 4]))  # ‚úÖ 6
print(max_profit([1, 2, 3, 4, 5]))  # ‚úÖ 4
print(max_profit([7, 6, 4, 3, 1]))  # ‚úÖ 0
print(max_profit([1, 4, 2, 7, 3, 6, 9, 0, 5]))  # ‚úÖ 13
