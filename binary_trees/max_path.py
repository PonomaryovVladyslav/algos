# –ó–∞–¥–∞—á–∞: –ù–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É –ø—É—Ç–∏ –≤ –±–∏–Ω–∞—Ä–Ω–æ–º –¥–µ—Ä–µ–≤–µ.
# –î–∞–Ω–æ: –∫–æ—Ä–µ–Ω—å `root` –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞.
# –ù—É–∂–Ω–æ: –Ω–∞–π—Ç–∏ –ø—É—Ç—å —Å –Ω–∞–∏–±–æ–ª—å—à–µ–π —Å—É–º–º–æ–π, –ø—Ä–æ—Ö–æ–¥—è—â–∏–π —á–µ—Ä–µ–∑ –ª—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤.

class TreeNode:
    """
    –ö–ª–∞—Å—Å —É–∑–ª–∞ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞.
    """
    def __init__(self, val: int = 0, left: "TreeNode" = None, right: "TreeNode" = None):
        self.val = val
        self.left = left
        self.right = right


def max_path_sum(root: TreeNode) -> int:
    """
    –§—É–Ω–∫—Ü–∏—è –≤—ã—á–∏—Å–ª—è–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É –ø—É—Ç–∏ –≤ –±–∏–Ω–∞—Ä–Ω–æ–º –¥–µ—Ä–µ–≤–µ.

    üîπ –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: O(n), —Ç–∞–∫ –∫–∞–∫ –º—ã –ø–æ—Å–µ—â–∞–µ–º –∫–∞–∂–¥—ã–π —É–∑–µ–ª —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑.
    üîπ –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: O(H), –≥–¥–µ `H` ‚Äî –≤—ã—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞ (–≥–ª—É–±–∏–Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–∏).

    :param root: TreeNode - –∫–æ—Ä–µ–Ω—å –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞.
    :return: int - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –ø—É—Ç–∏.
    """

    max_sum: float = float('-inf')

    def dfs(node: TreeNode | None) -> int:
        """
        –û–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞ –≤ –≥–ª—É–±–∏–Ω—É (DFS) –¥–ª—è –ø–æ–∏—Å–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏.

        :param node: TreeNode | None - —Ç–µ–∫—É—â–∏–π —É–∑–µ–ª.
        :return: int - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –ø—É—Ç–∏ –≤–Ω–∏–∑ (—Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –≤–µ—Ç–∫–∞).
        """
        nonlocal max_sum
        if not node:
            return 0

        left: int = max(dfs(node.left), 0)  # –û—Ç–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã
        right: int = max(dfs(node.right), 0)

        # –°—á–∏—Ç–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç —É–∑–µ–ª
        max_path: int = node.val + left + right
        max_sum = max(max_sum, max_path)

        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å –≤–Ω–∏–∑ (–æ–¥–Ω–∞ –≤–µ—Ç–∫–∞)
        return node.val + max(left, right)

    dfs(root)
    return max_sum


# üîπ –¢–µ—Å—Ç–∏—Ä—É–µ–º
tree = TreeNode(-10,
    TreeNode(9),
    TreeNode(20, TreeNode(15), TreeNode(7))
)

print(max_path_sum(tree))  # –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 42


"""
üîπ –ê–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:

‚úÖ –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: **O(n)**  
- –ú—ã –ø–æ—Å–µ—â–∞–µ–º –∫–∞–∂–¥—ã–π —É–∑–µ–ª **—Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑**.
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞ –º—ã –≤—ã–ø–æ–ª–Ω—è–µ–º **O(1) –æ–ø–µ—Ä–∞—Ü–∏–π**.

‚úÖ –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: **O(H)**  
- –í —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–µ—Ä–µ–≤–µ `H = log n` ‚Üí **O(log n)**.  
- –í –≤—ã—Ä–æ–∂–¥–µ–Ω–Ω–æ–º –¥–µ—Ä–µ–≤–µ `H = n` ‚Üí **O(n)** (–≥–ª—É–±–∏–Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–∏).

üìå **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º?**
1Ô∏è‚É£ **–†–µ–∫—É—Ä—Å–∏–≤–Ω–æ** –Ω–∞—Ö–æ–¥–∏–º **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —Å—É–º–º—ã –ª–µ–≤–æ–≥–æ –∏ –ø—Ä–∞–≤–æ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤—å–µ–≤**.
2Ô∏è‚É£ **–û—Ç–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã**, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ **—É–º–µ–Ω—å—à–∞—é—Ç –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**.
3Ô∏è‚É£ **–û–±–Ω–æ–≤–ª—è–µ–º `max_sum`**, –µ—Å–ª–∏ —Å—É–º–º–∞ —á–µ—Ä–µ–∑ —Ç–µ–∫—É—â–∏–π —É–∑–µ–ª **–±–æ–ª—å—à–µ** —Ç–µ–∫—É—â–µ–≥–æ `max_sum`.
4Ô∏è‚É£ –í–æ–∑–≤—Ä–∞—â–∞–µ–º **–º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É –æ–¥–Ω–æ–π –≤–µ—Ç–∫–∏** (`left` –∏–ª–∏ `right`), —á—Ç–æ–±—ã –ø–æ—Å—Ç—Ä–æ–∏—Ç—å **–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å**.

üí° **–ü–æ—á–µ–º—É –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º `max(left, right)` –≤ –≤–æ–∑–≤—Ä–∞—Ç–µ?**
- –ú—ã **–Ω–µ –º–æ–∂–µ–º –≤—ã–±—Ä–∞—Ç—å –æ–±–∞ –ø–æ–¥–¥–µ—Ä–µ–≤–∞**, —Ç–∞–∫ –∫–∞–∫ –ø—É—Ç—å –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ **–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–º –≤–Ω–∏–∑**.

"""
